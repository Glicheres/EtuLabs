Прошу строго не судить, но косяки подмечать.
Тесты проводились на массивах из 80 и 160 элементах. 
Настанет день, я добавлю голоп и превращу это в функцию.